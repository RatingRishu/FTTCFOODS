<h3 class="banner-title">
  Pan India Delivery Only <span>&#64;</span>49
</h3>

<section class="product-section">
  <div class="product-card-wrapper">

    <!-- Loop through products -->
    <div class="product-card" *ngFor="let product of products">
      <div class="card__shine"></div>
      <div class="card__glow"></div>
      <div class="product-content">

        <!-- Discount Badge -->
        <div class="discount-badge">{{ product.discount }}</div>

        <!-- Product Image / Video -->
        <div class="product-media">
          <ng-container *ngIf="product.type === 'video'; else imageTemplate">
            <video [src]="product.media" autoplay muted loop playsinline></video>
          </ng-container>
          <ng-template #imageTemplate>
            <img [src]="product.media" [alt]="product.title" />
          </ng-template>
        </div>

        <!-- Product Info -->
        <div class="product-info">
          <h4 class="product-title">{{ product.title }}</h4>
          <p class="product-tagline">{{ product.tagline }}</p>
          <p class="product-description" [innerHTML]="product.description"></p>
        </div>

        <!-- Footer -->
        <div class="product-footer">
          <span class="price">₹ {{ product.price }}/per Kg</span>
          <button class="buy-now-btn" (click)="addToCart(product)">Add to Cart</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Popup Card -->
  <div *ngIf="popupVisible" class="popup-card">
    <div class="popup-header">
      <h3>{{ selectedProduct?.title }} added to cart 🛒</h3>
      <button class="close-btn" (click)="closePopup()">❌</button>
    </div>
    <ul>
      <li *ngFor="let item of cart">
        {{ item.title }} - Qty: {{ item.quantity }} × ₹{{ item.price }} = ₹{{ item.price * item.quantity }}
      </li>
    </ul>
    <div class="popup-actions">
      <button (click)="goToCart()">Go to Cart</button>
      <button (click)="closePopup()">Continue Shopping</button>
    </div>
  </div>
</section>

<section class="testimonial">
  <h2>What Customers Say</h2>
  <blockquote>
    “{{ testimonial.message }}”<br />— {{ testimonial.author }}
  </blockquote>
  <app-show-case></app-show-case>
</section>

<!-- Cart + WhatsApp Order Section -->
<section class="cart-actions" *ngIf="cart.length > 0">
  <h2>🛒 Your Cart</h2>
  <ul>
    <li *ngFor="let item of cart; let i = index">
      {{ i + 1 }}. {{ item.title }} - 
      <button (click)="decreaseQuantity(i)" class="qty-btn">➖</button>
      {{ item.quantity }}
      <button (click)="increaseQuantity(i)" class="qty-btn">➕</button>
      × ₹{{ item.price }} = ₹{{ item.price * item.quantity }}
      <button (click)="removeFromCart(i)" class="remove-btn">❌</button>
    </li>
  </ul>
  <br>

  <!-- Total Amount -->
  <div class="cart-total">
    <p>Delivery Charge: ₹ {{ deliveryCharge }}</p>
    <p class="discount">
      🎉 Discount ({{ discountPercent }}% OFF):
      <strong>-₹{{ getDiscountAmount() }}</strong>
    </p>
    <strong>Final Total: ₹ {{ getFinalTotal() }}</strong>
  </div>
  <br>

  <!-- WhatsApp Order -->
  <div class="qr-container">
    <p>📱 Scan to Order via WhatsApp:</p>
    <img [src]="getWhatsAppQR()" alt="WhatsApp QR Code" class="qr-image" />
  </div>
  <br>
  <a [href]="getWhatsAppLink()" target="_blank" class="whatsapp-btn">
    Order via WhatsApp
  </a>
</section>
